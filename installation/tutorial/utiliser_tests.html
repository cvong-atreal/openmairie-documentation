

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="fr" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="fr" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Créer ses tests &mdash; openMairie Framework 4.11 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-doc-embed.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="https://openmairie.readthedocs.io/projects/omframework/fr/4.9/genindex.html" />
    <link rel="search" title="Recherche" href="https://openmairie.readthedocs.io/projects/omframework/fr/4.9/search.html" />
    <link rel="next" title="Manuel d’usage" href="https://openmairie.readthedocs.io/projects/omframework/fr/4.9/usage/index.html" />
    <link rel="prev" title="Créer ses états" href="utiliser_assistant.html" /> 

<!-- RTD Extra Head -->

<link rel="stylesheet" href="https://assets.readthedocs.org/static/css/readthedocs-doc-embed.css" type="text/css" />

<script type="application/json" id="READTHEDOCS_DATA">{"ad_free": false, "api_host": "https://readthedocs.org", "build_date": "2021-09-13T12:58:55Z", "builder": "sphinx", "canonical_url": null, "commit": "2d74cb2e", "docroot": "/source/", "features": {"docsearch_disabled": false}, "global_analytics_code": "UA-17997319-1", "language": "fr", "page": "tutorial/utiliser_tests", "programming_language": "py", "project": "omframework", "proxied_api_host": "/_", "source_suffix": ".rst", "subprojects": {}, "theme": "sphinx_rtd_theme", "user_analytics_code": "UA-55505927-1", "version": "4.11"}</script>

<!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
-->
<script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script>

<script type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-analytics.js" async="async"></script>

<!-- end RTD <extrahead> -->
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="https://openmairie.readthedocs.io/projects/omframework/fr/4.9/index.html" class="icon icon-home"> openMairie Framework 4.11
          

          
          </a>

          
            
            
            
              <div class="version">
                4.11
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="https://openmairie.readthedocs.io/projects/omframework/fr/4.9/search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="https://openmairie.readthedocs.io/projects/omframework/fr/4.9/installation/index.html">Prérequis et installation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutoriel - Créer une application</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="creer_base.html">Créer la base de données</a></li>
<li class="toctree-l2"><a class="reference internal" href="utiliser_generateur.html">Créer les formulaires</a></li>
<li class="toctree-l2"><a class="reference internal" href="personnaliser.html">Personnaliser son application</a></li>
<li class="toctree-l2"><a class="reference internal" href="modifier_base.html">Modifier la base et regénérer</a></li>
<li class="toctree-l2"><a class="reference internal" href="utiliser_assistant.html">Créer ses états</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="utiliser_tests.html#">Créer ses tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utiliser_tests.html#installation-et-parametrage">Installation  et paramètrage</a></li>
<li class="toctree-l3"><a class="reference internal" href="utiliser_tests.html#initialisation-de-la-base-de-donnees">Initialisation de la base de données</a></li>
<li class="toctree-l3"><a class="reference internal" href="utiliser_tests.html#simuler-l-ajout-d-un-nouvel-objet-par-l-utilisateur">Simuler l’ajout d’un nouvel objet par l’utilisateur</a></li>
<li class="toctree-l3"><a class="reference internal" href="utiliser_tests.html#tester-la-suppression-d-un-element">Tester la suppression d’un élément</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://openmairie.readthedocs.io/projects/omframework/fr/4.9/usage/index.html">Manuel d’usage</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://openmairie.readthedocs.io/projects/omframework/fr/4.9/reference/index.html">Manuel de référence</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://openmairie.readthedocs.io/projects/omframework/fr/4.9/tests_ci/index.html">Tests et Intégration Continue</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://openmairie.readthedocs.io/projects/omframework/fr/4.9/upgrades/index.html">Historique &amp; Mises à niveau</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://openmairie.readthedocs.io/projects/omframework/fr/4.9/rules/index.html">Règles</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://openmairie.readthedocs.io/projects/omframework/fr/4.9/tools/index.html">Outils</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="https://openmairie.readthedocs.io/projects/omframework/fr/4.9/index.html">openMairie Framework 4.11</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="https://openmairie.readthedocs.io/projects/omframework/fr/4.9/index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Tutoriel - Créer une application</a> &raquo;</li>
        
      <li>Créer ses tests</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://gitlab.com/openmairie/framework-openmairie-documentation/blob/4.9/source/tutorial/utiliser_tests.rst" class="fa fa-gitlab"> Edit on GitLab</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="creer-ses-tests">
<span id="utiliser-tests"></span><h1>Créer ses tests<a class="headerlink" href="utiliser_tests.html#creer-ses-tests" title="Lien permanent vers ce titre">¶</a></h1>
<p>Dans cette partie, nous allons voir comment mettre en place un système de tests automatisés permettant de vérifier le bon fonctionnement de notre application. Le lancement de ces tests servira à :</p>
<ul class="simple">
<li>Initialiser la base de données</li>
<li>Ajouter des emetteurs, services et courriers lors de l’initialisation</li>
<li>Saisir automatiquement dans le navigateur, à l’aide de sélénium, un emetteur, un service et un courrier</li>
<li>Vérifier qu’il n’est pas possible de supprimer un service et un emetteur liés à un courrier</li>
</ul>
<div class="section" id="installation-et-parametrage">
<h2>Installation  et paramètrage<a class="headerlink" href="utiliser_tests.html#installation-et-parametrage" title="Lien permanent vers ce titre">¶</a></h2>
<p>Commencer par vérifier que le répertoire <em>tests</em> existe. L’arborescence de ce répertoire est décrite ci-après: <a class="reference internal" href="https://openmairie.readthedocs.io/projects/omframework/fr/4.9/tests_ci/index.html#arborescence-repertoire-tests"><span class="std std-ref">arborescence du répertoire tests</span></a>.</p>
<p>Pour l’installation, dans <strong>Tests et Integration Continue</strong>, suivre la partie <a class="reference internal" href="https://openmairie.readthedocs.io/projects/omframework/fr/4.9/tests_ci/index.html#installation-tests"><span class="std std-ref">Installation</span></a>.</p>
<p>Aller ensuite dans <em>tests/binary_files/dyn/database.inc.php</em> et vérifier que le paramétrage d’accés à la base de données est correct, si ce n’est pas le cas le corriger.</p>
</div>
<div class="section" id="initialisation-de-la-base-de-donnees">
<h2>Initialisation de la base de données<a class="headerlink" href="utiliser_tests.html#initialisation-de-la-base-de-donnees" title="Lien permanent vers ce titre">¶</a></h2>
<p>Dans un premier temps, on va initialiser l’environnement de test. Pour cela, il faut que l’environnement de test soit activé((om-tests) present devant la ligne dans le terminal) et lancer la commande suivante depuis le repertoire tests :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">om</span><span class="o">-</span><span class="n">tests</span> <span class="o">-</span><span class="n">c</span> <span class="n">initenv</span>
</pre></div>
</div>
<p>Après initialisation, on peut constater que les tables service, emetteur et courrier n’existe plus dans la base de données. En effet, jusqu’à present ces tables ont été ajoutées à l’aide de postgres depuis le terminal, elles ne sont donc pas initilaiser dans le code. Pour remedier à cela, il faut ajouter, dans <em>data/pgsql/install.sql</em>, avant le commit, le code suivant :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span> <span class="n">Création</span> <span class="n">des</span> <span class="n">séquences</span>

<span class="n">CREATE</span> <span class="n">SEQUENCE</span> <span class="n">emetteur_seq</span>
<span class="n">START</span> <span class="n">WITH</span> <span class="mi">1</span>
<span class="n">INCREMENT</span> <span class="n">BY</span> <span class="mi">1</span>
<span class="n">NO</span> <span class="n">MINVALUE</span>
<span class="n">NO</span> <span class="n">MAXVALUE</span>
<span class="n">CACHE</span> <span class="mi">1</span><span class="p">;</span>

<span class="n">CREATE</span> <span class="n">SEQUENCE</span> <span class="n">service_seq</span>
<span class="n">START</span> <span class="n">WITH</span> <span class="mi">1</span>
<span class="n">INCREMENT</span> <span class="n">BY</span> <span class="mi">1</span>
<span class="n">NO</span> <span class="n">MINVALUE</span>
<span class="n">NO</span> <span class="n">MAXVALUE</span>
<span class="n">CACHE</span> <span class="mi">1</span><span class="p">;</span>

<span class="n">CREATE</span> <span class="n">SEQUENCE</span> <span class="n">courrier_seq</span>
<span class="n">START</span> <span class="n">WITH</span> <span class="mi">1</span>
<span class="n">INCREMENT</span> <span class="n">BY</span> <span class="mi">1</span>
<span class="n">NO</span> <span class="n">MINVALUE</span>
<span class="n">NO</span> <span class="n">MAXVALUE</span>
<span class="n">CACHE</span> <span class="mi">1</span><span class="p">;</span>

<span class="o">--</span> <span class="n">Création</span> <span class="n">des</span> <span class="n">tables</span>

<span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">emetteur</span> <span class="p">(</span>
    <span class="n">emetteur</span>          <span class="nb">int</span> <span class="n">PRIMARY</span> <span class="n">KEY</span><span class="p">,</span>  <span class="o">--</span> <span class="n">clé</span> <span class="n">primaire</span>
    <span class="n">nom</span>               <span class="n">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
    <span class="n">prenom</span>            <span class="n">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="p">);</span>

<span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">service</span> <span class="p">(</span>
    <span class="n">service</span>           <span class="nb">int</span> <span class="n">PRIMARY</span> <span class="n">KEY</span><span class="p">,</span>  <span class="o">--</span> <span class="n">clé</span> <span class="n">primaire</span>
    <span class="n">libelle</span>           <span class="n">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="p">);</span>

<span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">courrier</span> <span class="p">(</span>
    <span class="n">courrier</span>          <span class="nb">int</span> <span class="n">PRIMARY</span> <span class="n">KEY</span><span class="p">,</span>           <span class="o">--</span> <span class="n">clé</span> <span class="n">primaire</span>
    <span class="n">dateenvoi</span>         <span class="n">date</span><span class="p">,</span>
    <span class="n">objetcourrier</span>     <span class="n">text</span><span class="p">,</span>
    <span class="n">registre</span>          <span class="n">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
    <span class="n">emetteur</span>          <span class="nb">int</span> <span class="n">REFERENCES</span> <span class="n">emetteur</span><span class="p">,</span>   <span class="o">--</span> <span class="n">clé</span> <span class="n">étrangère</span>
    <span class="n">service</span>           <span class="nb">int</span> <span class="n">REFERENCES</span> <span class="n">service</span>     <span class="o">--</span> <span class="n">clé</span> <span class="n">étrangère</span>
<span class="p">);</span>
</pre></div>
</div>
<p>On va ensuite, remplir de manière automatique ces tables lors de l’initialisation. Dans le fichier <em>tests/data/pgsql/install_tests.sql</em> inserer, avant le commit, les lignes suivantes :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span> <span class="n">insertion</span> <span class="n">de</span> <span class="n">deux</span> <span class="n">émetteurs</span> <span class="n">avec</span> <span class="n">récupération</span> <span class="n">et</span> <span class="n">incrémentation</span> <span class="n">de</span> <span class="n">la</span> <span class="n">table</span> <span class="n">de</span> <span class="n">séquences</span>

<span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">emetteur</span> <span class="p">(</span><span class="n">emetteur</span><span class="p">,</span> <span class="n">nom</span><span class="p">,</span> <span class="n">prenom</span><span class="p">)</span> <span class="n">VALUES</span>
<span class="p">(</span><span class="n">nextval</span><span class="p">(</span><span class="s1">&#39;emetteur_seq&#39;</span><span class="p">),</span> <span class="s1">&#39;dupont&#39;</span><span class="p">,</span> <span class="s1">&#39;pierre&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="n">nextval</span><span class="p">(</span><span class="s1">&#39;emetteur_seq&#39;</span><span class="p">),</span> <span class="s1">&#39;durant&#39;</span><span class="p">,</span> <span class="s1">&#39;jacques&#39;</span><span class="p">);</span>

<span class="o">--</span> <span class="n">insertion</span> <span class="n">de</span> <span class="n">deux</span> <span class="n">services</span> <span class="n">avec</span> <span class="n">récupération</span> <span class="n">et</span> <span class="n">incrémentation</span> <span class="n">de</span> <span class="n">la</span> <span class="n">table</span> <span class="n">de</span> <span class="n">séquences</span>

<span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">service</span> <span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="n">libelle</span><span class="p">)</span> <span class="n">VALUES</span>
<span class="p">(</span><span class="n">nextval</span><span class="p">(</span><span class="s1">&#39;service_seq&#39;</span><span class="p">),</span> <span class="s1">&#39;informatique&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="n">nextval</span><span class="p">(</span><span class="s1">&#39;service_seq&#39;</span><span class="p">),</span> <span class="s1">&#39;telephonie&#39;</span><span class="p">);</span>

<span class="o">--</span> <span class="n">insertion</span> <span class="n">de</span> <span class="n">deux</span> <span class="n">courriers</span> <span class="n">avec</span> <span class="n">récupération</span> <span class="n">et</span> <span class="n">incrémentation</span> <span class="n">de</span> <span class="n">la</span> <span class="n">table</span> <span class="n">de</span> <span class="n">séquences</span>

<span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">courrier</span> <span class="p">(</span><span class="n">courrier</span><span class="p">,</span> <span class="n">dateenvoi</span><span class="p">,</span> <span class="n">objetcourrier</span><span class="p">,</span> <span class="n">emetteur</span><span class="p">,</span> <span class="n">service</span><span class="p">)</span> <span class="n">VALUES</span>
<span class="p">(</span><span class="n">nextval</span><span class="p">(</span><span class="s1">&#39;courrier_seq&#39;</span><span class="p">),</span> <span class="s1">&#39;2010-12-01&#39;</span><span class="p">,</span> <span class="s1">&#39;Proposition de fourniture de service&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="p">(</span><span class="n">nextval</span><span class="p">(</span><span class="s1">&#39;courrier_seq&#39;</span><span class="p">),</span> <span class="s1">&#39;2010-12-02&#39;</span><span class="p">,</span> <span class="s1">&#39;Envoi de devis pour formation openMairie&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<p>Relancer la commande initenv et verifier que les tables sont créées et remplies.</p>
</div>
<div class="section" id="simuler-l-ajout-d-un-nouvel-objet-par-l-utilisateur">
<h2>Simuler l’ajout d’un nouvel objet par l’utilisateur<a class="headerlink" href="utiliser_tests.html#simuler-l-ajout-d-un-nouvel-objet-par-l-utilisateur" title="Lien permanent vers ce titre">¶</a></h2>
<p>On cherche maintenant à ecrire un test permettant de simuler la creation d’un service, d’un emetteur et d’un courrier par l’utilisateur.</p>
<p>Dans le repertoire <em>tests</em> créer un nouveau fichier qu’on appelera <strong>012_mytest.robot</strong> et ajouter les lignes suivantes :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">***</span> <span class="n">Settings</span> <span class="o">***</span>
<span class="n">Resource</span>  <span class="n">resources</span><span class="o">/</span><span class="n">resources</span><span class="o">.</span><span class="n">robot</span>
<span class="n">Suite</span> <span class="n">Setup</span>  <span class="n">For</span> <span class="n">Suite</span> <span class="n">Setup</span>
<span class="n">Suite</span> <span class="n">Teardown</span>  <span class="n">For</span> <span class="n">Suite</span> <span class="n">Teardown</span>
<span class="n">Documentation</span>  <span class="n">TestSuite</span> <span class="s2">&quot;Mytest&quot;</span><span class="o">...</span>

<span class="o">***</span> <span class="n">Test</span> <span class="n">Cases</span> <span class="o">***</span>
</pre></div>
</div>
<p>On s’occupe ensuite de faire un test simulant l’ajout d’un service par l’utilisateur. En premier lieu, inserer à la suite du <strong>Test Cases</strong> le code suivant :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Ajouter</span> <span class="n">un</span> <span class="n">service</span>

    <span class="p">[</span><span class="n">Documentation</span><span class="p">]</span>  <span class="n">On</span> <span class="n">teste</span> <span class="n">l</span><span class="s1">&#39;ajout d&#39;</span><span class="n">un</span> <span class="n">service</span>
    <span class="o">...</span>  <span class="n">Le</span> <span class="n">service</span> <span class="n">ajouté</span> <span class="p">:</span>
    <span class="o">...</span>  <span class="s1">&#39;comptabilité&#39;</span>

    <span class="c1">#connection à l&#39;application</span>
    <span class="n">Depuis</span> <span class="n">la</span> <span class="n">page</span> <span class="n">d</span><span class="s1">&#39;accueil  admin  admin</span>
    <span class="c1">#On accéde à l&#39;écran des services</span>
    <span class="n">Go</span> <span class="n">To</span> <span class="n">Submenu</span> <span class="n">In</span> <span class="n">Menu</span>  <span class="n">parametrage</span>  <span class="n">service</span>
    <span class="c1">#On véerifie le titre de la page</span>
    <span class="n">Page</span> <span class="n">Title</span> <span class="n">Should</span> <span class="n">Be</span>  <span class="n">Application</span> <span class="o">&gt;</span> <span class="n">Service</span>
    <span class="c1">#On vérifie que le menu est ouvert sur l&#39;element correct</span>
    <span class="n">Submenu</span> <span class="n">In</span> <span class="n">Menu</span> <span class="n">Should</span> <span class="n">Be</span> <span class="n">Selected</span>  <span class="n">parametrage</span>  <span class="n">service</span>
    <span class="c1">#On clique sur le bouton ajouter</span>
    <span class="n">Click</span> <span class="n">On</span> <span class="n">Add</span> <span class="n">Button</span>
    <span class="c1">#On ajoute l&#39;element comptabilite</span>
    <span class="n">Input</span> <span class="n">Text</span>  <span class="n">css</span><span class="o">=</span><span class="c1">#libelle    comptabilité</span>
    <span class="c1">#On valide le formulaire</span>
    <span class="n">Click</span> <span class="n">On</span> <span class="n">Submit</span> <span class="n">Button</span>
    <span class="c1">#On vérifie que la page ne contiens pas d&#39;erreur</span>
    <span class="n">La</span> <span class="n">page</span> <span class="n">ne</span> <span class="n">doit</span> <span class="n">pas</span> <span class="n">contenir</span> <span class="n">d</span><span class="s1">&#39;erreur</span>
</pre></div>
</div>
<p>On peut ensuite lancer ce test avec la commande :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">om</span><span class="o">-</span><span class="n">tests</span> <span class="o">-</span><span class="n">c</span> <span class="n">runone</span> <span class="o">-</span><span class="n">t</span> <span class="mi">012</span><span class="n">_mytest</span><span class="o">.</span><span class="n">robot</span>
</pre></div>
</div>
<p>Les résultats de ces tests sont visibles dans <em>tests/results/log.html</em> et <em>tests/results/report.html</em></p>
<p>Vous devriez voir une fenetre firefox s’ouvrir sur l’application et réaliser une à une les étapes du test.</p>
<p><strong>Remarque</strong> : Le test simule, à l’aide de selenium, les actions réalisées par un utilisateur sur le navigateur. Par conséquent, si vous touchez au navigateur pendant que les tests s’effectuent cela aura un impact sur leur déroulement. Il ne faut donc pas toucher à la fenêtre pendant qu’un test est lancé.</p>
<p>Pour éviter d’être dérangé par le navigateur pendant que les tests sont lancés, on peut également lancer les commandes suivantes :</p>
<p><em>pour un seul tests</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xvfb</span><span class="o">-</span><span class="n">run</span> <span class="o">-</span><span class="n">a</span> <span class="o">--</span><span class="n">server</span><span class="o">-</span><span class="n">args</span><span class="o">=-</span><span class="n">screen</span>\ <span class="n">O</span>\ <span class="mi">1680</span><span class="o">*</span><span class="mi">1030</span><span class="o">*</span><span class="mi">24</span> <span class="n">om</span><span class="o">-</span><span class="n">test</span> <span class="o">-</span><span class="n">c</span> <span class="n">runone</span> <span class="o">-</span><span class="n">t</span> <span class="mi">012</span><span class="n">_mytest</span><span class="o">.</span><span class="n">robot</span>
</pre></div>
</div>
<p><em>pour lancer tous les tests</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xvfb</span><span class="o">-</span><span class="n">run</span> <span class="o">-</span><span class="n">a</span> <span class="o">--</span><span class="n">server</span><span class="o">-</span><span class="n">args</span><span class="o">=-</span><span class="n">screen</span>\ <span class="n">O</span>\ <span class="mi">1680</span><span class="o">*</span><span class="mi">1030</span><span class="o">*</span><span class="mi">24</span> <span class="n">om</span><span class="o">-</span><span class="n">test</span> <span class="o">-</span><span class="n">c</span> <span class="n">runall</span>
</pre></div>
</div>
<p>Ajouter, ensuite un emetteur :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Ajouter</span> <span class="n">un</span> <span class="n">emetteur</span>

    <span class="p">[</span><span class="n">Documentation</span><span class="p">]</span>  <span class="n">On</span> <span class="n">teste</span> <span class="n">l</span><span class="s1">&#39;ajout d&#39;</span><span class="n">un</span> <span class="n">emetteur</span>
    <span class="o">...</span>  <span class="n">Emetteur</span> <span class="n">ajouté</span> <span class="p">:</span>
    <span class="o">...</span>  <span class="n">nom</span> <span class="p">:</span> <span class="n">test</span><span class="p">,</span> <span class="n">prenom</span> <span class="p">:</span> <span class="n">jean</span>

    <span class="c1">#connection à l&#39;application</span>
    <span class="n">Depuis</span> <span class="n">la</span> <span class="n">page</span> <span class="n">d</span><span class="s1">&#39;accueil  admin  admin</span>
    <span class="c1">#On accéde à l&#39;écran des services</span>
    <span class="n">Go</span> <span class="n">To</span> <span class="n">Submenu</span> <span class="n">In</span> <span class="n">Menu</span>  <span class="n">parametrage</span>  <span class="n">emetteur</span>
    <span class="c1">#On véerifie le titre de la page</span>
    <span class="n">Page</span> <span class="n">Title</span> <span class="n">Should</span> <span class="n">Be</span>  <span class="n">Application</span> <span class="o">&gt;</span> <span class="n">Emetteur</span>
    <span class="c1">#On vérifie que le menu est ouvert sur l&#39;element correct</span>
    <span class="n">Submenu</span> <span class="n">In</span> <span class="n">Menu</span> <span class="n">Should</span> <span class="n">Be</span> <span class="n">Selected</span>  <span class="n">parametrage</span>  <span class="n">emetteur</span>
    <span class="c1">#On clique sur le bouton ajouter</span>
    <span class="n">Click</span> <span class="n">On</span> <span class="n">Add</span> <span class="n">Button</span>
    <span class="c1">#On entre le nom et le prenom de l&#39;emetteur</span>
    <span class="n">Input</span> <span class="n">Text</span>  <span class="n">css</span><span class="o">=</span><span class="c1">#nom        test</span>
    <span class="n">Input</span> <span class="n">Text</span>  <span class="n">css</span><span class="o">=</span><span class="c1">#prenom     jean</span>
    <span class="c1">#On valide le formulaire</span>
    <span class="n">Click</span> <span class="n">On</span> <span class="n">Submit</span> <span class="n">Button</span>
    <span class="c1">#On vérifie que la page ne contiens pas d&#39;erreur</span>
    <span class="n">La</span> <span class="n">page</span> <span class="n">ne</span> <span class="n">doit</span> <span class="n">pas</span> <span class="n">contenir</span> <span class="n">d</span><span class="s1">&#39;erreur</span>
</pre></div>
</div>
<p>Puis un courrier :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Ajouter</span> <span class="n">un</span> <span class="n">courrier</span>

    <span class="p">[</span><span class="n">Documentation</span><span class="p">]</span>  <span class="n">On</span> <span class="n">teste</span> <span class="n">l</span><span class="s1">&#39;ajout d&#39;</span><span class="n">un</span> <span class="n">courrier</span>
    <span class="o">...</span>  <span class="n">courrier</span> <span class="n">ajouté</span> <span class="p">:</span>
    <span class="o">...</span>  <span class="n">date</span> <span class="p">:</span> <span class="mi">09</span><span class="o">/</span><span class="mi">06</span><span class="o">/</span><span class="mi">2020</span><span class="p">,</span> <span class="n">objet</span> <span class="p">:</span> <span class="n">mangez</span> <span class="n">des</span> <span class="n">kiwis</span>
    <span class="o">...</span>  <span class="n">emetteur</span> <span class="p">:</span> <span class="n">test</span><span class="p">,</span> <span class="n">service</span> <span class="p">:</span> <span class="n">comptabilité</span>

    <span class="c1">#connection à l&#39;application</span>
    <span class="n">Depuis</span> <span class="n">la</span> <span class="n">page</span> <span class="n">d</span><span class="s1">&#39;accueil  admin  admin</span>
    <span class="c1">#On accéde à l&#39;écran des services</span>
    <span class="n">Go</span> <span class="n">To</span> <span class="n">Submenu</span> <span class="n">In</span> <span class="n">Menu</span>  <span class="n">parametrage</span>  <span class="n">courrier</span>
    <span class="c1">#On véerifie le titre de la page</span>
    <span class="n">Page</span> <span class="n">Title</span> <span class="n">Should</span> <span class="n">Be</span>  <span class="n">Application</span> <span class="o">&gt;</span> <span class="n">Courrier</span>
    <span class="c1">#On vérifie que le menu est ouvert sur l&#39;element correct</span>
    <span class="n">Submenu</span> <span class="n">In</span> <span class="n">Menu</span> <span class="n">Should</span> <span class="n">Be</span> <span class="n">Selected</span>  <span class="n">parametrage</span>  <span class="n">courrier</span>
    <span class="c1">#On clique sur le bouton ajouter</span>
    <span class="n">Click</span> <span class="n">On</span> <span class="n">Add</span> <span class="n">Button</span>
    <span class="c1">#On remplit les champs du courrier</span>
    <span class="n">Input</span> <span class="n">Datepicker</span>  <span class="n">dateenvoi</span>  <span class="mi">09</span><span class="o">/</span><span class="mi">06</span><span class="o">/</span><span class="mi">2020</span>
    <span class="n">Input</span> <span class="n">Text</span>  <span class="n">css</span><span class="o">=</span><span class="c1">#objetcourrier      mangez des kiwis</span>
    <span class="n">Select</span> <span class="n">From</span> <span class="n">List</span> <span class="n">By</span> <span class="n">Label</span>   <span class="n">css</span><span class="o">=</span><span class="c1">#emetteur   test</span>
    <span class="n">Select</span> <span class="n">From</span> <span class="n">List</span> <span class="n">By</span> <span class="n">Label</span>   <span class="n">css</span><span class="o">=</span><span class="c1">#service    comptabilité</span>
    <span class="c1">#On valide le formulaire</span>
    <span class="n">Click</span> <span class="n">On</span> <span class="n">Submit</span> <span class="n">Button</span>
    <span class="c1">#On vérifie que la page ne contiens pas d&#39;erreur</span>
    <span class="n">La</span> <span class="n">page</span> <span class="n">ne</span> <span class="n">doit</span> <span class="n">pas</span> <span class="n">contenir</span> <span class="n">d</span><span class="s1">&#39;erreur</span>
</pre></div>
</div>
</div>
<div class="section" id="tester-la-suppression-d-un-element">
<h2>Tester la suppression d’un élément<a class="headerlink" href="utiliser_tests.html#tester-la-suppression-d-un-element" title="Lien permanent vers ce titre">¶</a></h2>
<p>On cherche maintenant à vérifier que l’utilisateur ne peut pas supprimer un emetteur et/ou un service lié à un élément de la table courrier. Pour cela, on va se servir des mots clés générés automatiquement à partir du système de données.</p>
<p>Ajouter dans la partie <strong>Settings</strong> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#à la suite de Resource</span>
<span class="n">Resource</span>  <span class="n">resources</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">gen</span><span class="o">/</span><span class="n">service</span><span class="o">.</span><span class="n">robot</span>
</pre></div>
</div>
<p>Ajouter ensuite le test suivant :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Suppression</span> <span class="n">d</span><span class="s1">&#39;un service lié à la table courrier</span>

    <span class="p">[</span><span class="n">Documentation</span><span class="p">]</span>  <span class="n">On</span> <span class="n">teste</span> <span class="n">la</span> <span class="n">suppression</span> <span class="n">d</span><span class="s1">&#39;un service</span>
    <span class="o">...</span>  <span class="n">service</span> <span class="n">supprimé</span> <span class="p">:</span>
    <span class="o">...</span>  <span class="n">comptabilité</span>

    <span class="c1">#connection à l&#39;application</span>
    <span class="n">Depuis</span> <span class="n">la</span> <span class="n">page</span> <span class="n">d</span><span class="s1">&#39;accueil  admin  admin</span>
    <span class="c1">#On accéde à l&#39;écran des services</span>
    <span class="n">Go</span> <span class="n">To</span> <span class="n">Submenu</span> <span class="n">In</span> <span class="n">Menu</span>  <span class="n">parametrage</span>  <span class="n">service</span>
    <span class="c1">#On véerifie le titre de la page</span>
    <span class="n">Page</span> <span class="n">Title</span> <span class="n">Should</span> <span class="n">Be</span>  <span class="n">Application</span> <span class="o">&gt;</span> <span class="n">Service</span>
    <span class="c1">#On vérifie que le menu est ouvert sur l&#39;element correct</span>
    <span class="n">Submenu</span> <span class="n">In</span> <span class="n">Menu</span> <span class="n">Should</span> <span class="n">Be</span> <span class="n">Selected</span>  <span class="n">parametrage</span>  <span class="n">service</span>
    <span class="c1">#On supprime le service comptabilite</span>
    <span class="n">Supprimer</span> <span class="n">service</span>   <span class="mi">3</span>
    <span class="c1">#On verifie le message d&#39;erreur</span>
    <span class="n">Error</span> <span class="n">Message</span> <span class="n">Should</span> <span class="n">Contain</span>  <span class="n">SUPPRESSION</span> <span class="n">NON</span> <span class="n">EFFECTUÉE</span>
</pre></div>
</div>
<p><strong>Remarque</strong> : le mot clé «&nbsp;Supprimer service&nbsp;» est généré automatiquement à partir du modèle de données, dans le fichier <em>resources/app/gen/service.robot</em></p>
<p>De la même manière, vous pouvez écrire le test de suppression d’un emetteur et d’un courrier.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="https://openmairie.readthedocs.io/projects/omframework/fr/4.9/usage/index.html" class="btn btn-neutral float-right" title="Manuel d’usage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="utiliser_assistant.html" class="btn btn-neutral float-left" title="Créer ses états" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2004-2019, openMairie
      
        <span class="commit">
          Revision <code>2d74cb2e</code>.
        </span>
      

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: 4.11
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="https://openmairie.readthedocs.io/fr/4.10/">4.10</a></dd>
        
          <dd><a href="https://openmairie.readthedocs.io/fr/4.9/">4.9</a></dd>
        
          <dd><a href="https://openmairie.readthedocs.io/fr/4.8/">4.8</a></dd>
        
          <dd><a href="https://openmairie.readthedocs.io/fr/4.7/">4.7</a></dd>
        
          <dd><a href="https://openmairie.readthedocs.io/fr/4.6/">4.6</a></dd>
        
          <dd><a href="https://openmairie.readthedocs.io/fr/4.5/">4.5</a></dd>
        
          <dd><a href="https://openmairie.readthedocs.io/fr/4.4/">4.4</a></dd>
        
          <dd><a href="https://openmairie.readthedocs.io/fr/4.2/">4.2</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="https://openmairie.readthedocs.io/_/downloads/omframework/fr/4.9/pdf/">pdf</a></dd>
        
          <dd><a href="https://openmairie.readthedocs.io/_/downloads/omframework/fr/4.9/htmlzip/">html</a></dd>
        
          <dd><a href="https://openmairie.readthedocs.io/_/downloads/omframework/fr/4.9/epub/">epub</a></dd>
        
      </dl>
      <dl>
        <dt>On Read the Docs</dt>
          <dd>
            <a href="https://readthedocs.org/projects/omframework/?fromdocs=omframework">Project Home</a>
          </dd>
          <dd>
            <a href="https://readthedocs.org/builds/omframework/?fromdocs=omframework">Builds</a>
          </dd>
      </dl>
      <hr/>
      Free document hosting provided by <a href="http://www.readthedocs.org">Read the Docs</a>.

    </div>
  </div>



  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
   

</body>
</html>
